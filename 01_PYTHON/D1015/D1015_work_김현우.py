#___________________________________________________________________________________
# D1015 과제: 계산기 프로그램 만들기
# 김현우
#___________________________________________________________________________________
# 추가할 기능: 
#               - 숫자 입력, 사칙연산, 계산, 삭제 지원
#               - 창 크기 조절시 버튼들 확대/축소
#               - 마우스 클릭 및 Enter 키 이벤트 처리
#___________________________________________________________________________________
## 모듈 로딩 
#___________________________________________________________________________________
import tkinter as tk

#___________________________________________________________________________________
## 윈도우 관련 
#___________________________________________________________________________________
## 윈도우 창 인스턴스 생성 및 설정
window = tk.Tk()
window.title("사칙연산 계산기")
window.geometry("300x400")
window.resizable(True, True)  

# 현재 입력된 계산식 저장
current_input = ""  

## 결과 표시 - Entry 위젯
display = tk.Entry(window)
display.grid(row=0, column=0, 
             columnspan=4, 
             sticky="nsew",  # 꽉 채움
             padx=5, 
             pady=5)

#___________________________________________________________________________________
## 화면 초기화 함수(편의상 추가함)
#___________________________________________________________________________________
# 결과 표시 및 현재 입력값 갱신 
def update_display(text):
    global current_input
    
    display.delete(0, 'end')      # 기존 내용 제거
    display.insert('end', text)   # 새로운 텍스트 표시
    
    current_input = text          # 현재 입력값 갱신

#___________________________________________________________________________________
## 이벤트 처리(핸들러) 함수들
#___________________________________________________________________________________
## - 함수기능: 숫자 버튼 클릭
## - 함수이름: number_click
## - 매개변수: event
## - 반환결과: 없음
## - 기능설명: 클릭된 숫자를 입력창에 추가
#___________________________________________________________________________________
def number_click(event):
    global current_input
    
    number = event.widget['text']
    current_input += number
    
    update_display(current_input)

#___________________________________________________________________________________
## - 함수기능: 연산자 버튼 클릭 이벤트 처리
## - 함수이름: operator_click
## - 매개변수: event
## - 반환결과: 없음
## - 기능설명: 클릭된 연산자를 입력창에 추가
#___________________________________________________________________________________
def operator_click(event):
    global current_input
    
    operator = event.widget['text']
    current_input += operator
    
    update_display(current_input)

#___________________________________________________________________________________
## - 함수기능: 등호(=) 버튼 클릭 
## - 함수이름: equal_click
## - 매개변수: event
## - 반환결과: 없음
## - 기능설명: 입력된 수식을 계산하여 결과 표시, 오류 시 "ERROR" 표시
#___________________________________________________________________________________
def equal_click(event):
    global current_input
    
    try:
        result = str(eval(current_input))  # 계산 결과값 저장
        
        update_display(result)
        
    except:                                # 각종 오류 발생시
        update_display("ERROR")
        
#___________________________________________________________________________________
## - 함수기능: 클리어 버튼 클릭 
## - 함수이름: clear_click
## - 매개변수: event
## - 반환결과: 없음
## - 기능설명: 입력창의 모든 내용을 지움

#___________________________________________________________________________________
def clear_click(event):
    global current_input
    
    update_display("")
    
#___________________________________________________________________________________
## 그리드 모든 행/열 동일 비율로 설정
#___________________________________________________________________________________
for row in range(5):
    window.grid_rowconfigure(row, weight=1)  
    
for col in range(4):
    window.grid_columnconfigure(col, weight=1)
    
#___________________________________________________________________________________
## UI 위젯 생성 및 설정 - 버튼
#___________________________________________________________________________________
# 버튼 텍스트 정의
button_texts = [
    "7", "8", "9", "/",
    "4", "5", "6", "*", 
    "1", "2", "3", "-",
    "C", "0", "=", "+"
]

# 버튼 저장용 리스트
buttons = []

# 반복문으로 버튼 생성 및 배치
for i, text in enumerate(button_texts):
    
    btn = tk.Button(window, text=text)
    
    row = (i // 4) + 1  # 1행부터 시작(0행은 출력용)
    col = i % 4         # 0~3 반복
    
    btn.grid(row=row, column=col, 
             sticky="nsew", 
             padx=2, 
             pady=2) 
    
    buttons.append(btn)
    
#___________________________________________________________________________________
## 각 버튼에 클릭 이벤트 연결
#___________________________________________________________________________________
for btn in buttons:
    text = btn['text']
    
    if text.isdigit():                      # 숫자 버튼
        btn.bind("<Button-1>", number_click)
        
    elif text in ['+', '-', '*', '/']:      # 연산자 버튼
        btn.bind("<Button-1>", operator_click)
        
    elif text == '=':                       # 등호 버튼
        btn.bind("<Button-1>", equal_click)
        
    elif text == 'C':                       # 지우기 버튼
        btn.bind("<Button-1>", clear_click)

# Enter 키로도 계산 실행 가능
window.bind("<Return>", equal_click)
#___________________________________________________________________________________
## 윈도우에서 발생하는 사용자 이벤트 수신
#___________________________________________________________________________________
# 종료 전까지 동작
window.mainloop()
